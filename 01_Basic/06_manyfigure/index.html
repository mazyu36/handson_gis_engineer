<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>サンプルページ</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
  <!-- Make sure you put this AFTER Leaflet's CSS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

</head>

<body>
  <div id="map" style="height: 80vh;"></div>
  <script>
    const map = L.map('map', {
      center: [35.68, 139.7],
      zoom: 10,
    });


    // 複数のレイヤーを保持
    const baseLayers = {
      OpenStreetMap: L.tileLayer(
        'https://tile.openstreetmap.org/{z}/{x}/{y}.png', // OSMのテンプレート
        {
          maxZoom: 19,
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>Contributors' // CopyRight
        }
      ),
      地理院地図: L.tileLayer(
        'https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png', // 地理院タイル空中写真
        {
          maxZoom: 18,
          attribution:
            '<a href="https://maps.gsi.go.jp/development/ichiran.html">地理院タイル</a>',
        },
      ),
      空中写真: L.tileLayer(
        'https://cyberjapandata.gsi.go.jp/xyz/seamlessphoto/{z}/{x}/{y}.jpg',
        {
          maxZoom: 17,
          attribution:
            '<a href="https://maps.gsi.go.jp/development/ichiran.html">地理院タイル</a>',
        },
      ),
    }

    // 初期表示設定
    map.addLayer(baseLayers['OpenStreetMap']);

    // レイヤーの切り替え
    const layersControl = L.control
      .layers(baseLayers, [], { collapsed: false })
      .addTo(map)


    // DID追加
    fetch('./A16-15_00_DID.geojson')
      .then((res) => res.json())
      .then((json) => {
        const polygon = L.geoJSON(json, {
          style: (feature) => ({
            color: 'red',
            stroke: false,

            // 人口/面積でポリゴンの濃さを変更
            fillOpacity: feature.properties['人口'] /
              feature.properties['面積'] /
              20000
          })
        })
          .bindPopup((layer) => '人口: ' + layer.feature.properties['人口']).addTo(map)

        // レイヤー一覧に追加
        layersControl.addOverlay(polygon, '人口集中地区')
      })
  </script>


</body>

</html>